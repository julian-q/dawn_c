<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta property="og:title" content="Sampler" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://eliemichel.github.io/basic-3d-rendering/texturing/sampler.html" />
<meta property="og:site_name" content="Learn WebGPU for C++" />
<meta property="og:description" content="With webgpu.hpp Resulting code: step070 Vanilla webgpu.h Resulting code: step070-vanilla The textureLoad function that we used in our shader accesses the texture data almost as if it was a basic bu..." />
<meta property="og:image" content="https://eliemichel.github.io/images/webgpu-responsive.svg" />
<meta property="og:image:alt" content="Learn WebGPU for C++" />
<meta name="description" content="With webgpu.hpp Resulting code: step070 Vanilla webgpu.h Resulting code: step070-vanilla The textureLoad function that we used in our shader accesses the texture data almost as if it was a basic bu..." />
    <link rel="icon" type="image/svg+xml" href="../../_static/favicon/favicon.svg">
    <link rel="icon" sizes="16x16" href="../../_static/favicon/favicon-16x16.png" type="image/png">
    <link rel="icon" sizes="32x32" href="../../_static/favicon/favicon-32x32.png" type="image/png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://eliemichel.github.io/LearnWebGPU/_static/favicon/apple-touch-icon-180x180.png" type="image/png"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Loading from file" href="loading-from-file.html" /><link rel="prev" title="Texture mapping" href="texture-mapping.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>Sampler - Learn WebGPU for C++ documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../_static/extra.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx_literate.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #ac2800;
  --color-brand-content: #007cac;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  --color-brand-primary: #ce5733;
  --color-brand-content: #38a6b9;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  --color-brand-primary: #ce5733;
  --color-brand-content: #38a6b9;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<div class="announcement">
  <aside class="announcement-content">
     <em>Important</em> This documentation is a work in progress! <a href="../../appendices/feedback-needed.html">Feedback needed!</a> 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Learn WebGPU for C++  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../_static/webgpu-light.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../_static/webgpu-dark.svg" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../getting-started/index.html">Getting Started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/project-setup.html">Project setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/opening-a-window.html">Opening a window</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/hello-webgpu.html">Hello WebGPU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/the-adapter.html">The Adapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/the-device.html">The Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/the-command-queue.html">The Command Queue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/first-color.html">First Color</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/cpp-idioms.html">C++ wrapper</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Basic 3D Rendering</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../hello-triangle.html">Hello Triangle</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../input-geometry/index.html">Input Geometry</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../input-geometry/playing-with-buffers.html">Playing with buffers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../input-geometry/a-first-vertex-attribute.html">A first Vertex Attribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../input-geometry/multiple-attributes.html">Multiple Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../input-geometry/index-buffer.html">Index Buffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../input-geometry/loading-from-file.html">Loading from file</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../shader-uniforms/index.html">Shader Uniforms</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../shader-uniforms/a-first-uniform.html">A first uniform</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shader-uniforms/multiple-uniforms.html">More uniforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shader-uniforms/dynamic-uniforms.html">Dynamic uniforms</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../3d-meshes/index.html">3D Meshes</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../3d-meshes/a-simple-example.html">A simple example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3d-meshes/depth-buffer.html">Depth buffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3d-meshes/transformation-matrices.html">Transformation matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3d-meshes/projection-matrices.html">Projection matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3d-meshes/basic-shading.html">Basic shading</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3d-meshes/loading-from-file.html">Loading from file</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Texturing</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="a-first-texture.html">A first texture</a></li>
<li class="toctree-l3"><a class="reference internal" href="texture-mapping.html">Texture mapping</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="sampler.html#">Sampler</a></li>
<li class="toctree-l3"><a class="reference internal" href="loading-from-file.html">Loading from file</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../some-interaction/index.html">Some interaction</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../some-interaction/refactoring.html">Refactoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../some-interaction/resizing-window.html">Resizing the window</a></li>
<li class="toctree-l3"><a class="reference internal" href="../some-interaction/camera-control.html">Camera control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../some-interaction/simple-gui.html">Simple GUI</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../lighting-and-material/index.html">Lighting and Material</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../lighting-and-material/recap.html">Recap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lighting-and-material/specular.html">Specularity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lighting-and-material/normal-mapping.html">Normal mapping (🚧WIP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lighting-and-material/ibl.html">Image-Based Lighting (🚧WIP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lighting-and-material/cubemap.html">Cube Maps (🚧WIP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lighting-and-material/pbr.html">Physically-Based Materials (🚧WIP)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../basic-compute/index.html">Basic Compute</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../basic-compute/compute-pipeline.html">Compute Pipeline</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../basic-compute/image-processing/index.html">Image Processing</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../basic-compute/image-processing/mipmap-generation.html">Mipmap Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../basic-compute/image-processing/convolution-filters.html">Convolution Filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../basic-compute/image-processing/cubemap-conversion.html">Cubemap Conversion (🚧WIP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../basic-compute/image-processing/cubemap-prefiltering.html">Cubemap Prefiltering (🚧WIP)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../basic-compute/procedural-geometry/index.html">Procedural Geometry</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../basic-compute/procedural-geometry/deformation.html">Deformation (🚧WIP)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../basic-compute/neural-networks.html">Neural Networks (🛑TODO)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../advanced-techniques/index.html">Advanced Techniques</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../advanced-techniques/raii.html">RAII</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced-techniques/hdr-textures.html">High Dynamic Range Textures (🚧WIP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced-techniques/deferred-shading.html">Deferred Shading (🛑TODO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced-techniques/benchmarking.html">Benchmarking (🛑TODO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced-techniques/render-bundles.html">Render Bundles (🛑TODO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced-techniques/multi-sampling.html">Multi-Sampling (🛑TODO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced-techniques/scene-tree.html">Scene tree (🛑TODO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced-techniques/screen-capture.html">Screen capture (🚧WIP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced-techniques/shadow-maps.html">Shadow maps (🛑TODO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced-techniques/tesselation.html">Tesselation (🛑TODO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced-techniques/raytracing.html">Raytracing (🛑TODO)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../appendices/index.html">Appendices</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../appendices/teaching-native-graphics-in-2023.html">Teaching native graphics in 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendices/feedback-needed.html">Feedback needed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendices/debugging.html">Debugging (🚧WIP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendices/building-for-the-web.html">Building for the Web (🚧WIP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendices/memory-model.html">Memory Model (🛑TODO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendices/custom-extensions.html">Custom Extensions (🚧WIP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendices/references.html">References (🚧WIP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendices/tmp.html">Temporary page</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="sampler.html#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/eliemichel/LearnWebGPU/edit/main/./basic-3d-rendering/texturing/sampler.md" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section class="tex2jax_ignore mathjax_ignore" id="sampler">
<h1>Sampler<a class="headerlink" href="sampler.html#sampler" title="Permalink to this heading">#</a></h1>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">With webgpu.hpp</label><div class="tab-content docutils">
<p><em>Resulting code:</em> <a class="reference external" href="https://github.com/eliemichel/LearnWebGPU-Code/tree/step070"><code class="docutils literal notranslate"><span class="pre">step070</span></code></a></p>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">Vanilla webgpu.h</label><div class="tab-content docutils">
<p><em>Resulting code:</em> <a class="reference external" href="https://github.com/eliemichel/LearnWebGPU-Code/tree/step070-vanilla"><code class="docutils literal notranslate"><span class="pre">step070-vanilla</span></code></a></p>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">textureLoad</span></code> function that we used in our shader accesses the texture data almost as if it was a basic buffer. It <strong>does not benefit</strong> from the interpolation and mip level selection features that the GPU is capable of.</p>
<p>To <strong>sample</strong> values from a texture with all these capabilities, we define another resource called a <strong>sampler</strong>. We set it up to query the texture data in the way we’d like and then use the <code class="docutils literal notranslate"><span class="pre">textureSample</span></code> function in our shader.</p>
<section id="sampler-setup">
<h2>Sampler setup<a class="headerlink" href="sampler.html#sampler-setup" title="Permalink to this heading">#</a></h2>
<section id="sampler-creation">
<h3>Sampler creation<a class="headerlink" href="sampler.html#sampler-creation" title="Permalink to this heading">#</a></h3>
<p>I am going to detail the sampler settings in the second part of this chapter, once everything is wired up, so that we can directly experiment with it.</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">With webgpu.hpp</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="c1">//</span><span class="w"> </span><span class="c1">Create</span><span class="w"> </span><span class="c1">a</span><span class="w"> </span><span class="c1">sampler</span>
<span class="n">SamplerDescriptor</span><span class="w"> </span><span class="n">samplerDesc</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">addressModeU</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AddressMode</span><span class="o">::</span><span class="n">ClampToEdge</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">addressModeV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AddressMode</span><span class="o">::</span><span class="n">ClampToEdge</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">addressModeW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AddressMode</span><span class="o">::</span><span class="n">ClampToEdge</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">magFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FilterMode</span><span class="o">::</span><span class="n">Linear</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">minFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FilterMode</span><span class="o">::</span><span class="n">Linear</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">mipmapFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MipmapFilterMode</span><span class="o">::</span><span class="n">Linear</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">lodMinClamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">lodMaxClamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0f</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">compare</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CompareFunction</span><span class="o">::</span><span class="n">Undefined</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">maxAnisotropy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">Sampler</span><span class="w"> </span><span class="n">sampler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device</span><span class="p">.</span><span class="n">createSampler</span><span class="p">(</span><span class="n">samplerDesc</span><span class="p">);</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">Vanilla webgpu.h</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="c1">//</span><span class="w"> </span><span class="c1">Create</span><span class="w"> </span><span class="c1">a</span><span class="w"> </span><span class="c1">sampler</span>
<span class="n">WGPUSamplerDescriptor</span><span class="w"> </span><span class="n">samplerDesc</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">addressModeU</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUAddressMode_ClampToEdge</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">addressModeV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUAddressMode_ClampToEdge</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">addressModeW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUAddressMode_ClampToEdge</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">magFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUFilterMode_Linear</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">minFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUFilterMode_Linear</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">mipmapFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUMipmapFilterMode_Linear</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">lodMinClamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">lodMaxClamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0f</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">compare</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUCompareFunction_Undefined</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">maxAnisotropy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">WGPUSampler</span><span class="w"> </span><span class="n">sampler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wgpuDeviceCreateSampler</span><span class="p">(</span><span class="n">device</span><span class="p">,</span><span class="w"> </span><span class="n">samplerDesc</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>We need to raise the following device limits:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">requiredLimits</span><span class="p">.</span><span class="n">limits</span><span class="p">.</span><span class="n">maxSampledTexturesPerShaderStage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="n">requiredLimits</span><span class="p">.</span><span class="n">limits</span><span class="p">.</span><span class="n">maxSamplersPerShaderStage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="sampler-binding">
<h3>Sampler binding<a class="headerlink" href="sampler.html#sampler-binding" title="Permalink to this heading">#</a></h3>
<p>Adding a new binding should feel rather straightforward by now:</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">With webgpu.hpp</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">BindGroupLayoutEntry</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bindingLayoutEntries</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">Default</span><span class="p">);</span>
<span class="c1">//</span><span class="w">                                                     </span><span class="c1">^</span><span class="w"> </span><span class="c1">This</span><span class="w"> </span><span class="c1">was</span><span class="w"> </span><span class="c1">a</span><span class="w"> </span><span class="c1">2</span>

<span class="n">BindGroupLayoutEntry</span><span class="o">&amp;</span><span class="w"> </span><span class="n">samplerBindingLayout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bindingLayoutEntries</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="n">samplerBindingLayout</span><span class="p">.</span><span class="n">binding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="n">samplerBindingLayout</span><span class="p">.</span><span class="n">visibility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ShaderStage</span><span class="o">::</span><span class="n">Fragment</span><span class="p">;</span>
<span class="n">samplerBindingLayout</span><span class="p">.</span><span class="n">sampler</span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SamplerBindingType</span><span class="o">::</span><span class="n">Filtering</span><span class="p">;</span>

<span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>

<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">BindGroupEntry</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bindings</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="c1">//</span><span class="w">                                   </span><span class="c1">^</span><span class="w"> </span><span class="c1">This</span><span class="w"> </span><span class="c1">was</span><span class="w"> </span><span class="c1">a</span><span class="w"> </span><span class="c1">2</span>

<span class="n">bindings</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">binding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="n">bindings</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">sampler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sampler</span><span class="p">;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">Vanilla webgpu.h</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">WGPUBindGroupLayoutEntry</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bindingLayoutEntries</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">Default</span><span class="p">);</span>
<span class="c1">//</span><span class="w">                                                     </span><span class="c1">^</span><span class="w"> </span><span class="c1">This</span><span class="w"> </span><span class="c1">was</span><span class="w"> </span><span class="c1">a</span><span class="w"> </span><span class="c1">2</span>

<span class="n">WGPUBindGroupLayoutEntry</span><span class="o">&amp;</span><span class="w"> </span><span class="n">samplerBindingLayout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bindingLayoutEntries</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="n">samplerBindingLayout</span><span class="p">.</span><span class="n">binding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="n">samplerBindingLayout</span><span class="p">.</span><span class="n">visibility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUShaderStage_Fragment</span><span class="p">;</span>
<span class="n">samplerBindingLayout</span><span class="p">.</span><span class="n">sampler</span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUSamplerBindingType_Filtering</span><span class="p">;</span>

<span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>

<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">WGPUBindGroupEntry</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bindings</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="c1">//</span><span class="w">                                   </span><span class="c1">^</span><span class="w"> </span><span class="c1">This</span><span class="w"> </span><span class="c1">was</span><span class="w"> </span><span class="c1">a</span><span class="w"> </span><span class="c1">2</span>

<span class="n">bindings</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">binding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="n">bindings</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">sampler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sampler</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="sampler-usage">
<h3>Sampler usage<a class="headerlink" href="sampler.html#sampler-usage" title="Permalink to this heading">#</a></h3>
<p>The sampler simply uses the <code class="docutils literal notranslate"><span class="pre">sampler</span></code> type. Once bound, we can use <code class="docutils literal notranslate"><span class="pre">textureSample(t,</span> <span class="pre">s,</span> <span class="pre">uv)</span></code> to sample the texture <code class="docutils literal notranslate"><span class="pre">t</span></code> at UV <code class="docutils literal notranslate"><span class="pre">uv</span></code> using the sampler <code class="docutils literal notranslate"><span class="pre">s</span></code>:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="o">@</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">@</span><span class="n">binding</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="n">textureSampler</span>:<span class="w"> </span><span class="nc">sampler</span><span class="p">;</span>

<span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>

<span class="o">@</span><span class="n">fragment</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">fs_main</span><span class="p">(</span><span class="k">in</span>:<span class="w"> </span><span class="nc">VertexOutput</span><span class="p">)</span><span class="w"> </span>-&gt;<span class="w"> </span><span class="o">@</span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">vec4</span><span class="o">&lt;</span><span class="kt">f32</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">textureSample</span><span class="p">(</span><span class="n">gradientTexture</span><span class="p">,</span><span class="w"> </span><span class="n">textureSampler</span><span class="p">,</span><span class="w"> </span><span class="k">in</span><span class="p">.</span><span class="n">uv</span><span class="p">).</span><span class="n">rgb</span><span class="p">;</span>
<span class="w">    </span><span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>
<span class="p">}</span>
</pre></div>
</div>
<figure class="align-center" id="id1">
<img alt="../../_images/sampled-cube.png" class="with-shadow" src="../../_images/sampled-cube.png" />
<figcaption>
<p><span class="caption-text">The cube, textured using a filtering sampler.</span><a class="headerlink" href="sampler.html#id1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="adressing">
<h2>Adressing<a class="headerlink" href="sampler.html#adressing" title="Permalink to this heading">#</a></h2>
<p>The first part of the sampler settings is rather easy to understand. The address mode tells for each axis of the coordinate space (U, V, and W for 3D textures) how to handle values that are <strong>out of the range</strong> <span class="math notranslate nohighlight">\((0,1)\)</span>.</p>
<p>To illustrate this, we go back to our plane example and edit the <strong>vertex shader</strong> to scale and offset the UVs.</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="n">out</span><span class="p">.</span><span class="n">uv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">in</span><span class="p">.</span><span class="n">uv</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>
</pre></div>
</div>
<figure class="align-center" id="id2">
<img alt="../../_images/clamp-to-edge.png" class="with-shadow" src="../../_images/clamp-to-edge.png" />
<figcaption>
<p><span class="caption-text">With the ClampToEdge mode, UVs out of the <span class="math notranslate nohighlight">\((0,1)\)</span> range are clamped to <span class="math notranslate nohighlight">\(0\)</span> or <span class="math notranslate nohighlight">\(1\)</span>.</span><a class="headerlink" href="sampler.html#id2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Note that if we switch back to raw texture loading, out of bounds texels return a null color:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">texelCoords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vec2</span><span class="o">&lt;</span><span class="kt">i32</span><span class="o">&gt;</span><span class="p">(</span><span class="k">in</span><span class="p">.</span><span class="n">uv</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">vec2</span><span class="o">&lt;</span><span class="kt">f32</span><span class="o">&gt;</span><span class="p">(</span><span class="n">textureDimensions</span><span class="p">(</span><span class="n">gradientTexture</span><span class="p">)));</span>
<span class="kd">let</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">textureLoad</span><span class="p">(</span><span class="n">gradientTexture</span><span class="p">,</span><span class="w"> </span><span class="n">texelCoords</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">).</span><span class="n">rgb</span><span class="p">;</span>
</pre></div>
</div>
<figure class="align-center" id="id3">
<img alt="../../_images/transformed-uv.png" class="with-shadow" src="../../_images/transformed-uv.png" />
<figcaption>
<p><span class="caption-text">Raw texture loading returns a null color when out of bounds.</span><a class="headerlink" href="sampler.html#id3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Back to a sampled texture, let us now try a different value for the U address mode:</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">With webgpu.hpp</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">samplerDesc</span><span class="p">.</span><span class="n">addressModeU</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AddressMode</span><span class="o">::</span><span class="n">Repeat</span><span class="p">;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">Vanilla webgpu.h</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">samplerDesc</span><span class="p">.</span><span class="n">addressModeU</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUAddressMode_Repeat</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-center" id="id4">
<img alt="../../_images/repeat-u.png" class="with-shadow" src="../../_images/repeat-u.png" />
<figcaption>
<p><span class="caption-text">The Repeat mode set on U repeats the texture infinitly.</span><a class="headerlink" href="sampler.html#id4" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The last address mode, which we can try on the V axis, repeats with a mirroring effect:</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">With webgpu.hpp</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">samplerDesc</span><span class="p">.</span><span class="n">addressModeV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AddressMode</span><span class="o">::</span><span class="n">MirrorRepeat</span><span class="p">;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">Vanilla webgpu.h</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">samplerDesc</span><span class="p">.</span><span class="n">addressModeV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUAddressMode_MirrorRepeat</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-center" id="id5">
<img alt="../../_images/mirror-v.png" class="with-shadow" src="../../_images/mirror-v.png" />
<figcaption>
<p><span class="caption-text">The Repeat mode set on V repeats the texture with mirroring.</span><a class="headerlink" href="sampler.html#id5" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="filtering">
<h2>Filtering<a class="headerlink" href="sampler.html#filtering" title="Permalink to this heading">#</a></h2>
<p>The next sampler settings are about <strong>filtering</strong>, which is the most powerful part of the sampler. There are two types of filtering.</p>
<section id="magnifying-filtering">
<h3>Magnifying filtering<a class="headerlink" href="sampler.html#magnifying-filtering" title="Permalink to this heading">#</a></h3>
<p>Magnifying filtering consists in interpolating (i.e., mixing) the value of two neighboring pixels when a fragment samples a location that falls <strong>between two round texel coordinates</strong>.</p>
<p>We can compare the two possible filters:</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">With webgpu.hpp</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">samplerDesc</span><span class="p">.</span><span class="n">magFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FilterMode</span><span class="o">::</span><span class="n">Nearest</span><span class="p">;</span>
<span class="c1">//</span><span class="w"> </span><span class="c1">versus</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">magFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FilterMode</span><span class="o">::</span><span class="n">Linear</span><span class="p">;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">Vanilla webgpu.h</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">samplerDesc</span><span class="p">.</span><span class="n">magFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUFilterMode_Nearest</span><span class="p">;</span>
<span class="c1">//</span><span class="w"> </span><span class="c1">versus</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">magFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUFilterMode_Linear</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<img alt="../../_images/mag-filter-light.svg" class="only-light align-center" src="../../_images/mag-filter-light.svg" /><img alt="../../_images/mag-filter-dark.svg" class="only-dark align-center" src="../../_images/mag-filter-dark.svg" /><p class="align-center">
	<span class="caption-text"><em>Different magnifying filters.</em></span>
</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Nearest</span></code> mode corresponds to rounding to the closest integer texel coordinate, which corresponds roughly to what we had with raw texel loading (not exactly because we were truncating coordinates rather than rounding).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Linear</span></code> mode, commonly used, corresponds to mixing coordinates from <code class="docutils literal notranslate"><span class="pre">floor(u</span> <span class="pre">*</span> <span class="pre">width)</span></code> and <code class="docutils literal notranslate"><span class="pre">floor((u</span> <span class="pre">+</span> <span class="pre">1)</span> <span class="pre">*</span> <span class="pre">width)</span></code> with factor <code class="docutils literal notranslate"><span class="pre">fract(u</span> <span class="pre">*</span> <span class="pre">width)</span></code>.</p>
</section>
<section id="minifying-filtering">
<h3>Minifying filtering<a class="headerlink" href="sampler.html#minifying-filtering" title="Permalink to this heading">#</a></h3>
<section id="aliasing">
<h4>Aliasing<a class="headerlink" href="sampler.html#aliasing" title="Permalink to this heading">#</a></h4>
<p>This filter is deactivated in our current setup (because we have only 1 mip level), and we can highlight the issue that minifying filtering addresses by moving the camera over the plane:</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">With webgpu.hpp</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">samplerDesc</span><span class="p">.</span><span class="n">addressModeU</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AddressMode</span><span class="o">::</span><span class="n">Repeat</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">addressModeV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AddressMode</span><span class="o">::</span><span class="n">Repeat</span><span class="p">;</span>

<span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>

<span class="c1">//</span><span class="w"> </span><span class="c1">In</span><span class="w"> </span><span class="c1">the</span><span class="w"> </span><span class="c1">main</span><span class="w"> </span><span class="c1">loop</span>
<span class="kt">float</span><span class="w"> </span><span class="n">viewZ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glm</span><span class="o">::</span><span class="n">mix</span><span class="p">(</span><span class="mf">0.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.25f</span><span class="p">,</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">PI</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">uniforms</span><span class="p">.</span><span class="n">time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="p">);</span>
<span class="n">uniforms</span><span class="p">.</span><span class="n">viewMatrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glm</span><span class="o">::</span><span class="n">lookAt</span><span class="p">(</span><span class="n">vec3</span><span class="p">(</span><span class="mf">-0.5f</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.5f</span><span class="p">,</span><span class="w"> </span><span class="n">viewZ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.25f</span><span class="p">),</span><span class="w"> </span><span class="n">vec3</span><span class="p">(</span><span class="mf">0.0f</span><span class="p">),</span><span class="w"> </span><span class="n">vec3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="n">queue</span><span class="p">.</span><span class="n">writeBuffer</span><span class="p">(</span><span class="n">uniformBuffer</span><span class="p">,</span><span class="w"> </span><span class="n">offsetof</span><span class="p">(</span><span class="n">MyUniforms</span><span class="p">,</span><span class="w"> </span><span class="n">viewMatrix</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">uniforms</span><span class="p">.</span><span class="n">viewMatrix</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">MyUniforms</span><span class="o">::</span><span class="n">viewMatrix</span><span class="p">));</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">Vanilla webgpu.h</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">samplerDesc</span><span class="p">.</span><span class="n">addressModeU</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUAddressMode_Repeat</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">addressModeV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUAddressMode_Repeat</span><span class="p">;</span>

<span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>

<span class="c1">//</span><span class="w"> </span><span class="c1">In</span><span class="w"> </span><span class="c1">the</span><span class="w"> </span><span class="c1">main</span><span class="w"> </span><span class="c1">loop</span>
<span class="kt">float</span><span class="w"> </span><span class="n">viewZ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glm</span><span class="o">::</span><span class="n">mix</span><span class="p">(</span><span class="mf">0.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.25f</span><span class="p">,</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">PI</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">uniforms</span><span class="p">.</span><span class="n">time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="p">);</span>
<span class="n">uniforms</span><span class="p">.</span><span class="n">viewMatrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glm</span><span class="o">::</span><span class="n">lookAt</span><span class="p">(</span><span class="n">vec3</span><span class="p">(</span><span class="mf">-0.5f</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.5f</span><span class="p">,</span><span class="w"> </span><span class="n">viewZ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.25f</span><span class="p">),</span><span class="w"> </span><span class="n">vec3</span><span class="p">(</span><span class="mf">0.0f</span><span class="p">),</span><span class="w"> </span><span class="n">vec3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="n">wgpuQueueWriteBuffer</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span><span class="w"> </span><span class="n">uniformBuffer</span><span class="p">,</span><span class="w"> </span><span class="n">offsetof</span><span class="p">(</span><span class="n">MyUniforms</span><span class="p">,</span><span class="w"> </span><span class="n">viewMatrix</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">uniforms</span><span class="p">.</span><span class="n">viewMatrix</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">MyUniforms</span><span class="o">::</span><span class="n">viewMatrix</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="c1">//</span><span class="w"> </span><span class="c1">Repeat</span><span class="w"> </span><span class="c1">the</span><span class="w"> </span><span class="c1">texture</span><span class="w"> </span><span class="c1">6</span><span class="w"> </span><span class="c1">times</span><span class="w"> </span><span class="c1">along</span><span class="w"> </span><span class="c1">each</span><span class="w"> </span><span class="c1">axis</span>
<span class="n">out</span><span class="p">.</span><span class="n">uv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">in</span><span class="p">.</span><span class="n">uv</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">6.0</span><span class="p">;</span>
</pre></div>
</div>
<figure class="align-center">
	<video autoplay loop muted inline nocontrols style="width:100%;height:auto;max-width:642px">
		<source src="../../_static/aliasing.mp4" type="video/mp4">
	</video>
	<figcaption>
		<p><span class="caption-text">When texels become smaller than pixels, a lot of <strong>aliasing</strong> artifacts emerges.</span></p>
	</figcaption>
</figure>
<p>This is terrible, and appears any time a large texture is applied on an object that appears small (e.g., because it is far from the viewer).</p>
<p>The key problem is that <strong>when a screen pixel covers a lot of texels</strong>, a naive sampling procedure takes the color of one of the texels only, whereas the pixel should be colored with the <strong>average</strong> color of all the texels it covers.</p>
<img alt="../../_images/min-filter-light.svg" class="only-light align-center" src="../../_images/min-filter-light.svg" /><img alt="../../_images/min-filter-dark.svg" class="only-dark align-center" src="../../_images/min-filter-dark.svg" /><p class="align-center">
	<span class="caption-text"><em>The aliasing occurs when the <strong>footprint</strong> of a pixel covers multiple texels.</em></span>
</p>
</section>
<section id="mip-mapping">
<h4>Mip-mapping<a class="headerlink" href="sampler.html#mip-mapping" title="Permalink to this heading">#</a></h4>
<p>It takes too much time to measure the average of all texels in the pixel footprint (imagine when the object is textured with a 4K map but appears on a 100 px area).</p>
<p>What can we do? We <strong>precompute</strong> many possible averages, store them into extra images called <strong>mip maps</strong>. The minifying filtering is thus more commonly called <strong>mip-mapping</strong>. This takes more memory, but not that much (twice the initial texture memory) compared to how it speeds things up.</p>
<p>We can already change the description of our texture, and of the texture view provided to the sampler, to allocate room for <strong>storing the extra mip levels</strong>:</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">With webgpu.hpp</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">textureDesc</span><span class="p">.</span><span class="n">mipLevelCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span>

<span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>

<span class="n">textureViewDesc</span><span class="p">.</span><span class="n">mipLevelCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">textureDesc</span><span class="p">.</span><span class="n">mipLevelCount</span><span class="p">;</span>

<span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>

<span class="c1">//</span><span class="w"> </span><span class="c1">Also</span><span class="w"> </span><span class="c1">setup</span><span class="w"> </span><span class="c1">the</span><span class="w"> </span><span class="c1">sampler</span><span class="w"> </span><span class="c1">to</span><span class="w"> </span><span class="c1">use</span><span class="w"> </span><span class="c1">these</span><span class="w"> </span><span class="c1">mip</span><span class="w"> </span><span class="c1">levels</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">minFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FilterMode</span><span class="o">::</span><span class="n">Linear</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">mipmapFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MipmapFilterMode</span><span class="o">::</span><span class="n">Linear</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">lodMinClamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">lodMaxClamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.0f</span><span class="p">;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">Vanilla webgpu.h</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">textureDesc</span><span class="p">.</span><span class="n">mipLevelCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span>

<span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>

<span class="n">textureViewDesc</span><span class="p">.</span><span class="n">mipLevelCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">textureDesc</span><span class="p">.</span><span class="n">mipLevelCount</span><span class="p">;</span>

<span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>

<span class="c1">//</span><span class="w"> </span><span class="c1">Also</span><span class="w"> </span><span class="c1">setup</span><span class="w"> </span><span class="c1">the</span><span class="w"> </span><span class="c1">sampler</span><span class="w"> </span><span class="c1">to</span><span class="w"> </span><span class="c1">use</span><span class="w"> </span><span class="c1">these</span><span class="w"> </span><span class="c1">mip</span><span class="w"> </span><span class="c1">levels</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">minFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUFilterMode_Linear</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">mipmapFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUMipmapFilterMode_Linear</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">lodMinClamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">;</span>
<span class="n">samplerDesc</span><span class="p">.</span><span class="n">lodMaxClamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.0f</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>After allocating these mip levels, we can see that the sampler uses our texture data only for the closest part of the plane. Beyond this, it samples black color because we left the <strong>extra mip levels uninitialized</strong>:</p>
<figure class="align-center" id="id6">
<img alt="../../_images/mip0.png" class="with-shadow" src="../../_images/mip0.png" />
<figcaption>
<p><span class="caption-text">Closest points are sampled from the mip level 0, which contains our texture. Other mip levels are filled with black pixels.</span><a class="headerlink" href="sampler.html#id6" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The size of each mip level is half the size of the previous one, until one of the dimensions reaches 1 and is no longer divisible. This defines the maximum number of mip levels (as specified <a class="reference external" href="https://www.w3.org/TR/webgpu/#abstract-opdef-maximum-miplevel-count">here</a>):</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="c1">//</span><span class="w"> </span><span class="c1">Equivalent</span><span class="w"> </span><span class="c1">of</span><span class="w"> </span><span class="c1">std::bit_width</span><span class="w"> </span><span class="c1">that</span><span class="w"> </span><span class="c1">is</span><span class="w"> </span><span class="c1">available</span><span class="w"> </span><span class="c1">from</span><span class="w"> </span><span class="c1">C++20</span><span class="w"> </span><span class="c1">onward</span>
<span class="kt">uint32_t</span><span class="w"> </span><span class="nf">bit_width</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">++</span><span class="n">w</span><span class="p">;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">w</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">uint32_t</span><span class="w"> </span><span class="n">maxMipLevelCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bit_width</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">textureDesc</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">textureDesc</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="p">));</span>
</pre></div>
</div>
</div>
</section>
<section id="mip-level-data">
<h4>Mip-level data<a class="headerlink" href="sampler.html#mip-level-data" title="Permalink to this heading">#</a></h4>
<p>Now we need to compute the data of these other mip levels. For each level, we issue a <code class="docutils literal notranslate"><span class="pre">queue.writeTexture</span></code> call to load the data for that level.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In a later part of this tutorial, we will use compute shaders to fill in the mip levels given the level 0 directly on the GPU, as this is more efficient.</p>
</div>
<p>Let us enclose the texture data uploading in a loop over each mip level:</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">With webgpu.hpp</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">Extent3D</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">textureDesc</span><span class="p">.</span><span class="n">size</span><span class="p">;</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">textureDesc</span><span class="p">.</span><span class="n">mipLevelCount</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">level</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//</span><span class="w"> </span><span class="c1">Create</span><span class="w"> </span><span class="c1">image</span><span class="w"> </span><span class="c1">data</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pixels</span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">height</span><span class="p">);</span>
<span class="w">    </span><span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>

<span class="w">    </span><span class="n">ImageCopyTexture</span><span class="w"> </span><span class="n">destination</span><span class="p">;</span>
<span class="w">    </span><span class="n">destination</span><span class="p">.</span><span class="n">mipLevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">level</span><span class="p">;</span><span class="w"> </span><span class="c1">//</span><span class="w"> </span><span class="c1">change</span><span class="w"> </span><span class="c1">this</span><span class="w"> </span><span class="c1">to</span><span class="w"> </span><span class="c1">the</span><span class="w"> </span><span class="c1">current</span><span class="w"> </span><span class="c1">level</span>
<span class="w">    </span><span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>

<span class="w">    </span><span class="n">TextureDataLayout</span><span class="w"> </span><span class="n">source</span><span class="p">;</span>
<span class="w">    </span><span class="n">source</span><span class="p">.</span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">source</span><span class="p">.</span><span class="n">bytesPerRow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">width</span><span class="p">;</span><span class="w"> </span><span class="c1">//</span><span class="w"> </span><span class="c1">compute</span><span class="w"> </span><span class="c1">from</span><span class="w"> </span><span class="c1">the</span><span class="w"> </span><span class="c1">mip</span><span class="w"> </span><span class="c1">level</span><span class="w"> </span><span class="c1">size</span>
<span class="w">    </span><span class="n">source</span><span class="p">.</span><span class="n">rowsPerImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">height</span><span class="p">;</span>

<span class="w">    </span><span class="n">queue</span><span class="p">.</span><span class="n">writeTexture</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">pixels</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">pixels</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="p">);</span>

<span class="w">    </span><span class="c1">//</span><span class="w"> </span><span class="c1">The</span><span class="w"> </span><span class="c1">size</span><span class="w"> </span><span class="c1">of</span><span class="w"> </span><span class="c1">the</span><span class="w"> </span><span class="c1">next</span><span class="w"> </span><span class="c1">mip</span><span class="w"> </span><span class="c1">level:</span>
<span class="w">    </span><span class="c1">//</span><span class="w"> </span><span class="c1">(see</span><span class="w"> </span><span class="c1">https://www.w3.org/TR/webgpu/#logical-miplevel-specific-texture-extent)</span>
<span class="w">    </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--2">Vanilla webgpu.h</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">Extent3D</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">textureDesc</span><span class="p">.</span><span class="n">size</span><span class="p">;</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">textureDesc</span><span class="p">.</span><span class="n">mipLevelCount</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">level</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//</span><span class="w"> </span><span class="c1">Create</span><span class="w"> </span><span class="c1">image</span><span class="w"> </span><span class="c1">data</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pixels</span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">height</span><span class="p">);</span>
<span class="w">    </span><span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>

<span class="w">    </span><span class="n">ImageCopyTexture</span><span class="w"> </span><span class="n">destination</span><span class="p">;</span>
<span class="w">    </span><span class="n">destination</span><span class="p">.</span><span class="n">mipLevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">level</span><span class="p">;</span><span class="w"> </span><span class="c1">//</span><span class="w"> </span><span class="c1">change</span><span class="w"> </span><span class="c1">this</span><span class="w"> </span><span class="c1">to</span><span class="w"> </span><span class="c1">the</span><span class="w"> </span><span class="c1">current</span><span class="w"> </span><span class="c1">level</span>
<span class="w">    </span><span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>

<span class="w">    </span><span class="n">TextureDataLayout</span><span class="w"> </span><span class="n">source</span><span class="p">;</span>
<span class="w">    </span><span class="n">source</span><span class="p">.</span><span class="n">bytesPerRow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">width</span><span class="p">;</span><span class="w"> </span><span class="c1">//</span><span class="w"> </span><span class="c1">compute</span><span class="w"> </span><span class="c1">from</span><span class="w"> </span><span class="c1">the</span><span class="w"> </span><span class="c1">mip</span><span class="w"> </span><span class="c1">level</span><span class="w"> </span><span class="c1">size</span>
<span class="w">    </span><span class="n">source</span><span class="p">.</span><span class="n">rowsPerImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">height</span><span class="p">;</span>
<span class="w">    </span><span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>

<span class="w">    </span><span class="n">wgpuQueueWriteTexture</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">pixels</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">pixels</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="p">);</span>

<span class="w">    </span><span class="c1">//</span><span class="w"> </span><span class="c1">The</span><span class="w"> </span><span class="c1">size</span><span class="w"> </span><span class="c1">of</span><span class="w"> </span><span class="c1">the</span><span class="w"> </span><span class="c1">next</span><span class="w"> </span><span class="c1">mip</span><span class="w"> </span><span class="c1">level:</span>
<span class="w">    </span><span class="c1">//</span><span class="w"> </span><span class="c1">(see</span><span class="w"> </span><span class="c1">https://www.w3.org/TR/webgpu/#logical-miplevel-specific-texture-extent)</span>
<span class="w">    </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>If the level is 0, <code class="docutils literal notranslate"><span class="pre">pixels</span></code> is filled as previously. For extra levels, let us start with some plain color for debugging:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="c1">//</span><span class="w"> </span><span class="c1">Create</span><span class="w"> </span><span class="c1">image</span><span class="w"> </span><span class="c1">data</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">width</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">height</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">uint8_t</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pixels</span><span class="p">[</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">)];</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">level</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">//</span><span class="w"> </span><span class="c1">Some</span><span class="w"> </span><span class="c1">debug</span><span class="w"> </span><span class="c1">value</span><span class="w"> </span><span class="c1">for</span><span class="w"> </span><span class="c1">visualizing</span><span class="w"> </span><span class="c1">mip</span><span class="w"> </span><span class="c1">levels</span>
<span class="w">            </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">            </span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">level</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">            </span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">level</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">255</span><span class="p">;</span><span class="w"> </span><span class="c1">//</span><span class="w"> </span><span class="c1">a</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You should now see a <strong>gradient</strong> depending on the distance of the points to the camera. Each color of the gradient corresponds to texels sampled from a different mip level.</p>
<p>Again, <strong>the sampler automatically figures out</strong> which level to sample. It does so based on the difference of UV coordinate between two neighbor pixels.</p>
<img alt="../../_images/min-pyramid-light.svg" class="only-light align-center" src="../../_images/min-pyramid-light.svg" /><img alt="../../_images/min-pyramid-dark.svg" class="only-dark align-center" src="../../_images/min-pyramid-dark.svg" /><p class="align-center">
	<span class="caption-text"><em>The <strong>MIP pyramid</strong> of a texture is the usual way of visualizing its different mip levels. Each level contains a filtered and downscaled version of the previous level.</em></span>
</p>
<p>Note that the sampler actually blends from multiple mip levels for an even more continuous visual response. This can be deactivated by changing the <code class="docutils literal notranslate"><span class="pre">mipmapFilter</span></code>:</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--1">With webgpu.hpp</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">samplerDesc</span><span class="p">.</span><span class="n">mipmapFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MipmapFilterMode</span><span class="o">::</span><span class="n">Nearest</span><span class="p">;</span><span class="w"> </span><span class="c1">//</span><span class="w"> </span><span class="c1">instead</span><span class="w"> </span><span class="c1">of</span><span class="w"> </span><span class="c1">Linear</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--2">Vanilla webgpu.h</label><div class="tab-content docutils">
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">samplerDesc</span><span class="p">.</span><span class="n">mipmapFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WGPUMipmapFilterMode_Nearest</span><span class="p">;</span><span class="w"> </span><span class="c1">//</span><span class="w"> </span><span class="c1">instead</span><span class="w"> </span><span class="c1">of</span><span class="w"> </span><span class="c1">Linear</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-center" id="id7">
<img alt="../../_images/mip-nearest.png" class="with-shadow" src="../../_images/mip-nearest.png" />
<figcaption>
<p><span class="caption-text">The debugging mip levels with Nearest mip-map filter mode.</span><a class="headerlink" href="sampler.html#id7" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>We can now fill in the mip levels with the actual filtered data: each texel of level <span class="math notranslate nohighlight">\(i\)</span> is the average of 4 texels from level <span class="math notranslate nohighlight">\(i - 1\)</span>.</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">previousLevelPixels</span><span class="p">;</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">textureDesc</span><span class="p">.</span><span class="n">mipLevelCount</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">level</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span><span class="w"> </span><span class="c1">In</span><span class="w"> </span><span class="c1">the</span><span class="w"> </span><span class="c1">loop</span><span class="w"> </span><span class="c1">over</span><span class="w"> </span><span class="c1">pixels</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">level</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//</span><span class="w"> </span><span class="c1">Get</span><span class="w"> </span><span class="c1">the</span><span class="w"> </span><span class="c1">corresponding</span><span class="w"> </span><span class="c1">4</span><span class="w"> </span><span class="c1">pixels</span><span class="w"> </span><span class="c1">from</span><span class="w"> </span><span class="c1">the</span><span class="w"> </span><span class="c1">previous</span><span class="w"> </span><span class="c1">level</span>
<span class="w">        </span><span class="kt">uint8_t</span><span class="o">*</span><span class="w"> </span><span class="n">p00</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">previousLevelPixels</span><span class="p">[</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">((</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">width</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">))];</span>
<span class="w">        </span><span class="kt">uint8_t</span><span class="o">*</span><span class="w"> </span><span class="n">p01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">previousLevelPixels</span><span class="p">[</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">((</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">width</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">))];</span>
<span class="w">        </span><span class="kt">uint8_t</span><span class="o">*</span><span class="w"> </span><span class="n">p10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">previousLevelPixels</span><span class="p">[</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">((</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">width</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">))];</span>
<span class="w">        </span><span class="kt">uint8_t</span><span class="o">*</span><span class="w"> </span><span class="n">p11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">previousLevelPixels</span><span class="p">[</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">((</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mipLevelSize</span><span class="p">.</span><span class="n">width</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">))];</span>
<span class="w">        </span><span class="c1">//</span><span class="w"> </span><span class="c1">Average</span>
<span class="w">        </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">p00</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p01</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p10</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p11</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">        </span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">p00</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p01</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p10</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p11</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">        </span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">p00</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p01</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p10</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p11</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">//</span><span class="w"> </span><span class="c1">[...]</span>

<span class="w">    </span><span class="n">previousLevelPixels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">pixels</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>For the sake of simplicity, I assumed here that we were using a texture whose dimensions is a power of 2 so that it is always possible to divide the size by 2. When it is not the case, one must take care of borders.</p>
</div>
<p>Our sampler is thus able to provide texture samples that produce <strong>way less aliasing artifacts</strong>! (Don’t forget to switch back the <code class="docutils literal notranslate"><span class="pre">mipmapFilter</span></code> to <code class="docutils literal notranslate"><span class="pre">Linear</span></code>):</p>
<figure class="align-center">
	<video autoplay loop muted inline nocontrols style="width:100%;height:auto;max-width:642px">
		<source src="../../_static/anti-aliasing.mp4" type="video/mp4">
	</video>
	<figcaption>
		<p><span class="caption-text">Our checkerboard texture, properly sampled with mip-mapping.</span></p>
	</figcaption>
</figure>
<p>We can still see a little bit of aliasing at grazing angles. This is due to the fact that the MIP pyramid precomputes <strong>isotropic</strong> averages, which footprint is a regular square, but at grazing angle a pixel’s footprint is an elongated trapezoid.</p>
<p>This <strong>anisotropy</strong> is partially taken into account by the sampler (through the <code class="docutils literal notranslate"><span class="pre">maxAnisotropy</span></code> option), but not perfectly. Nevertheless, this is much more acceptable that the initial aliasing that we had!</p>
</section>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="sampler.html#conclusion" title="Permalink to this heading">#</a></h2>
<p>We can now properly use textures in our scenes!</p>
<p>We have seen how to fill in mip maps, which can be computed in any way you want. Even though they very often contain averages, filtering is a complex topic, and other operations can be used. For mip-mapping depth buffers, one would use a max (and the <code class="docutils literal notranslate"><span class="pre">compare</span></code> option that I did not detail). For normal and roughness data (which we’ll discover in the <a class="reference internal" href="../lighting-and-material/index.html"><span class="std std-doc">Lighting and Material</span></a> chapter), other techniques must be found because an average is not physically correct.</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--10-input--1" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--1">With webgpu.hpp</label><div class="tab-content docutils">
<p><em>Resulting code:</em> <a class="reference external" href="https://github.com/eliemichel/LearnWebGPU-Code/tree/step070"><code class="docutils literal notranslate"><span class="pre">step070</span></code></a></p>
</div>
<input class="tab-input" id="tab-set--10-input--2" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--2">Vanilla webgpu.h</label><div class="tab-content docutils">
<p><em>Resulting code:</em> <a class="reference external" href="https://github.com/eliemichel/LearnWebGPU-Code/tree/step070-vanilla"><code class="docutils literal notranslate"><span class="pre">step070-vanilla</span></code></a></p>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="loading-from-file.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Loading from file</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="texture-mapping.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Texture mapping</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022-2023, Élie Michel and contributors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/eliemichel/LearnWebGPU" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      <div class="toc-sticky toc-scroll">
	<div class="toc-title-container">
		<span class="toc-title">
			On this page
		</span>
	</div>
	<div class="toc-tree-container">
		<div class="toc-tree">
			<ul>
<li><a class="reference internal" href="sampler.html#">Sampler</a><ul>
<li><a class="reference internal" href="sampler.html#sampler-setup">Sampler setup</a><ul>
<li><a class="reference internal" href="sampler.html#sampler-creation">Sampler creation</a></li>
<li><a class="reference internal" href="sampler.html#sampler-binding">Sampler binding</a></li>
<li><a class="reference internal" href="sampler.html#sampler-usage">Sampler usage</a></li>
</ul>
</li>
<li><a class="reference internal" href="sampler.html#adressing">Adressing</a></li>
<li><a class="reference internal" href="sampler.html#filtering">Filtering</a><ul>
<li><a class="reference internal" href="sampler.html#magnifying-filtering">Magnifying filtering</a></li>
<li><a class="reference internal" href="sampler.html#minifying-filtering">Minifying filtering</a><ul>
<li><a class="reference internal" href="sampler.html#aliasing">Aliasing</a></li>
<li><a class="reference internal" href="sampler.html#mip-mapping">Mip-mapping</a></li>
<li><a class="reference internal" href="sampler.html#mip-level-data">Mip-level data</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="sampler.html#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

		</div>
	</div>
	
</div>
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/tabs.js"></script>
    <script src="../../_static/sphinx_literate.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>